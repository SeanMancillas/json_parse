<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>JSON to Table Converter</title>
  </head>
  <body>
    <form>
      <label for="json-input">Paste your JSON here:</label>
      <br>
      <textarea id="json-input" rows="10" cols="50"></textarea>
      <br>
      <button id="interpret-button">Interpret</button>
    </form>
    <table id="output-table">
      <thead>
        <tr>
          <th>Key</th>
          <th>Value</th>
          <th>Mapping</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>

    <script>
      const interpretButton = document.getElementById('interpret-button');
      interpretButton.addEventListener('click', () => {
        const jsonInput = document.getElementById('json-input').value;
        const jsonData = JSON.parse(jsonInput);
        const outputTableBody = document.querySelector('#output-table tbody');
        outputTableBody.innerHTML = '';
        const flattenObject = (obj, path = []) => {
          return Object.assign({}, ...Object.keys(obj).map(key => {
            const newPath = path.concat(key);
            if (typeof obj[key] === 'object') {
              return flattenObject(obj[key], newPath);
            } else {
              return { [newPath.join('.')]: obj[key] };
            }
          }));
        };
        const flattenedData = flattenObject(jsonData.event_data);
        for (const [key, value] of Object.entries(flattenedData)) {
          const newRow = document.createElement('tr');
          const keyCell = document.createElement('td');
          keyCell.textContent = key;
          newRow.appendChild(keyCell);
          const valueCell = document.createElement('td');
          valueCell.textContent = value;
          newRow.appendChild(valueCell);
          const mappingCell = document.createElement('td');
          const mappingDropdown = document.createElement('select');
          const mappingOptions = ['Name', 'Email', 'Property', 'Disregard'];
          for (const option of mappingOptions) {
            const mappingOption = document.createElement('option');
            mappingOption.value = option.toLowerCase();
            mappingOption.textContent = option;
            mappingDropdown.appendChild(mappingOption);
          }
          mappingCell.appendChild(mappingDropdown);
          newRow.appendChild(mappingCell);
          outputTableBody.appendChild(newRow);
        }
      });
    </script>
  </body>
</html>
